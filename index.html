<html>
<head>
    <title>JY's Calculator</title>
	<link rel="stylesheet" type="text/css" href="./public/css/popup.css">
        <script src='./public/js/math.js' type='text/javascript'></script>
        <script src='./public/js/jquery.min.js' type='text/javascript'></script>
        <script src='./public/js/plotly-latest.min.js' type='text/javascript'></script>

</head>
 
<body>
        <h1></h1>
    <div id="calculator">
            
        <textarea id="result" wrap="soft" onclick="savePosition()"></textarea>

        <!-- 비교연산 -->
        <div class="menu">
            <input type="checkbox" href="#" class="menu-open" name="diff-menu-open" id="diff-menu-open"/>
            <label class="menu-open-button" for="diff-menu-open">비교연산</label>
            <div id="diff-F">
                    <div class="key menu-item diff-">==</div>
                    <div class="key menu-item diff-">!=</div>
                    <div class="key menu-item diff-"><</div>
                    <div class="key menu-item diff-">></div>
                    <div class="key menu-item diff-"><=</div>
                    <div class="key menu-item diff-">>=</div>
            </div>
        </div>
        
        <!-- 행렬 (procession)-->
        <div class="menu">
            <input type="checkbox" href="#" class="menu-open" name="const-menu-open" id="proc-menu-open"/>
            <label class="menu-open-button" for="proc-menu-open">행렬</label>
            <div id="proc-F">
                    <div class="key menu-item proc- spec-key">det()</div>
                    <div class="key menu-item proc- spec-key">inv()</div>
            </div>
        </div>

        <!-- 상수 -->
        <div class="menu">
            <input type="checkbox" href="#" class="menu-open" name="const-menu-open" id="const-menu-open"/>
            <label class="menu-open-button" for="const-menu-open">상수</label>
            <div id="const-F">
                    <div class="key menu-item const- var-key">e</div>
                    <div class="key menu-item const- var-key">pi</div>
            </div>
        </div>

        <!-- 변수 -->
        <div class="menu">
            <input type="checkbox" href="#" class="menu-open" name="var-menu-open" id="var-menu-open"/>
            <label class="menu-open-button" for="var-menu-open">변수</label>
            <div id="var-F">
                    <div class="key menu-item var- var-key">x</div>
                    <div class="key menu-item var- var-key">y</div>
                    <div class="key menu-item var- var-key">z</div>
                    <div class="key menu-item var- var-key">=</div>
            </div>
        </div>

        <!-- 함수 -->
        <div class="menu">
            <input type="checkbox" href="#" class="menu-open" name="func-menu-open" id="func-menu-open"/>
            <label class="menu-open-button" for="func-menu-open">함수</label>
            <div id="func-F">
                    <div class="key menu-item func- func-key">f()</div>
                    <div class="key menu-item func- func-key">g()</div>
                    <div class="key menu-item func- func-key">h()</div>
                    <div class="key menu-item func- func-key">=</div>
            </div>
        </div>

        <!-- 특수 계산 -->
        <div class="menu">
            <input type="checkbox" href="#" class="menu-open" name="spec-menu-open" id="spec-menu-open"/>
            <label class="menu-open-button" for="spec-menu-open">지수로그</label>
            <div id="spec-F">
                <div class="key menu-item spec- spec-key">log()</div>
                <div class="key menu-item spec- spec-key">exp()</div>
                <div class="key menu-item spec- spec-key">sqrt()</div>
                <div class="key menu-item spec- spec-key">^</div>
            </div>
        </div>

        <!-- 삼각함수 -->
        <div class="menu">
            <input type="checkbox" href="#" class="menu-open" name="tri-menu-open" id="tri-menu-open"/>
            <label class="menu-open-button" for="tri-menu-open">삼각함수</label>
            <div id="tri-F">
                <div class="key menu-item tri- spec-key">sin()</div>
                <div class="key menu-item tri- spec-key">cos()</div>
                <div class="key menu-item tri- spec-key">tan()</div>
                <div class="key menu-item tri- spec-key">asin()</div>
                <div class="key menu-item tri- spec-key">acos()</div>
                <div class="key menu-item tri- spec-key">atan()</div>
            </div>
        </div>

        <!-- 참조 : http://mathjs.org/examples/browser/plot.html.html -->
        <div class="menu">
                <input type="checkbox" href="#" class="menu-open" name="mode-menu-open" id="mode-menu-open"/>
                <label class="mode-open-button" for="mode-menu-open">함수<br>그리기</label>
        </div>
      
        <div id="graph_div" style="z-index: 3;position:absolute;">
                <div id ="plot">

                </div>
                
                <div class="slidecontainer" id="slidecontainer-min">
                        <input type="button" class="range-button" value="-" onclick="changetick(this.value, getObject('slidecontainer-min'))">
                        <ruby>
                                <input type="range" list="tickmarks-min" style="padding:6px" id="rmin" min="0" max="50" value="0" step="1" class="slider" onchange="range(this.value, getObject('slidecontainer-min'))">
                                <rt id="lb_range_min" style="font-size:4px;">1 12 25 38 50</rt>
                        </ruby>
                        <datalist id="tickmarks-min">
                                <option value="1">
                                <option value="12">
                                <option value="25">
                                <option value="38">
                                <option value="50">
                        </datalist>
                        <input type="button" class="range-button"  value="+" onclick="changetick(this.value, getObject('slidecontainer-min'))">
                </div>

                <div class="slidecontainer" id="slidecontainer-max">
                        <input type="button" class="range-button" value="-" onclick="changetick(this.value, getObject('slidecontainer-max'))">
                        <ruby>
                                <input type="range" list="tickmarks-max" style="padding:6px" id="rmax" min="0" max="50" value="25" step="1" class="slider" onchange="range(this.value, getObject('slidecontainer-max'))">
                                <rt id="lb_range_max" style="font-size:4px;">1 12 25 38 50</rt>
                        </ruby>
                        <datalist id="tickmarks-max">
                                <option value="1">
                                <option value="12">
                                <option value="25">
                                <option value="38">
                                <option value="50">
                        </datalist>
                        <input type="button" class="range-button"  value="+" onclick="changetick(this.value, getObject('slidecontainer-max'))">
                </div>
        </div>

        <div class="outside-key key">[</div>
        <div class="outside-key key">]</div>
        <div class="outside-key key">:</div>
        <div class="outside-key key">;</div>
        <div class="outside-key key spec-key" style="line-height: 30px;">cross</div>

        <div class="outside-key key">(</div>
        <div class="outside-key key">)</div>
        <div class="outside-key key" style="line-height: 45px;">,</div>
        <div class="outside-key key">-</div>
        <div class="outside-key key var-key" style="line-height: 30px;">i</div>

        
        <div class="outside-key key num-key">1</div>
        <div class="outside-key key num-key">2</div>
        <div class="outside-key key num-key">3</div>
        <div class="outside-key key clear-key">DEL</div>
        <div class="outside-key key clear-key">AC</div>

        <div class="outside-key key num-key">4</div>
        <div class="outside-key key num-key">5</div>
        <div class="outside-key key num-key">6</div>
        <div class="outside-key key cal-key">+</div>
        <div class="outside-key key cal-key">*</div>

        <div class="outside-key key num-key">7</div>
        <div class="outside-key key num-key">8</div>
        <div class="outside-key key num-key">9</div>
        <div class="outside-key key cal-key">-</div>
        <div class="outside-key key cal-key">/</div>

        <div class="outside-key key" style="font-size:15px">ExAns</div>
        <div class="outside-key key num-key">0</div>
        <div class="outside-key key">.</div>
        <div class="outside-key key cal-key">%</div>
        <div id="eval"class="outside-key key eval-key">=</div>
</body>

    <!-- key 클릭 시 값 입력 JS -->
    <script type="text/javascript">
            var dict = {};
            var dataSize = 0;
            var drawMin = 0;
            var drawMax = 25;
            var currentPos=0;
            var displayValue = '';
            //첫 입력으로 0이 입력 될때, 연속 계산을 할 때
            // 인식 위한 check boolean변수
            var bool_click = false;
            $(document).ready(function(){
                var parser = math.parser();
                var exAns = '';      //이전값 기억 변수
                var eexAns = '';     //AC를 눌렀을 경우 exAns를 통해 바로 계산할 경우
                //계산에 실수가 생겨 하나 더 만들었다.
                //displayValue는 공백으로, 결과창은 0으로 표시 위함.
                $('#result').text('0');

                $('.key').each(function(index, key){
                    $(this).click(function(e){
                        if(bool_click == false){
                                $('#result').text(displayValue);
                        }
                        //계산완료 버튼을 눌렀을 때 화면과 value값을 지워준다.
                        //연속 계산위해 연산자 클릭을 할 경우 해당 if문 내에서 exAns를 이용하여
                        //계산 결과를 도출 해준다.
                        if(displayValue == '0' && bool_click == false){
                            displayValue = '';
                            $('#result').text(displayValue);
                        }

                        var okey = $(this);
                        var exdisplayvalue;

                        if(okey.hasClass("eval-key"))
                        {
                            try
                            {
                                    //한번 계산해서 function인지 파악, 아니라면 round씌워서 재계산
                                exdisplayvalue = displayValue;
                                var tempResult = displayValue = parser.eval(displayValue).toString();
                                var tokens = tempResult.split(' ');
                                var funcTokens;
                                if(tokens[0] == 'function')
                                {
                                        displayValue = tokens[0];
                                        functokens = exdisplayvalue.split('=');
                                        dict[functokens[0]] = functokens[1];
                                        dataSize++;
                                        $('#result').text(displayValue);
                                        displayValue = '0';
                                        exAns = displayValue;
                                        eexAns = displayValue;
                                        currentPos = 0;
                                }
                                else{
                                        displayValue = parser.eval('round(' + displayValue + ', 3)').toString();
                                        $('#result').text(displayValue);
                                        exAns = displayValue;
                                        eexAns = displayValue;
                                        //반올림 해주면서 currentPos값이 변하여 결과값 도출 이후에
                                        //currentPos값을 맨 뒤로 보내기 위함.
                                        currentPos = displayValue.length;
                                        displayValue = '0';
                                        currentPos = 0;
                                }
                                bool_click = false;
                            }
                            catch (e)
                            {
                                displayValue = '0';
                                if(displayValue != 'function')
                                {
                                    $('#result').text(e);
                                }
                            }               
                        }//이전 값 더해주기
                        else if(okey.text() == 'ExAns'){
                                currentPos = insertAtCursor("result",exAns,currentPos, exAns.length);
                                bool_click = true;
                        }
                        else
                        {
                            if(okey.text() == 'AC')
                            {
                                displayValue = '0';
                                currentPos = 0;
                                bool_click = false;
                                $('#result').text(displayValue);
                                eexAns = '';
                            }
                            else if(okey.text() == 'DEL'){
                                currentPos = deleteAtCursor("result",currentPos);
                                bool_click = true;
                            }
                            else if(okey.text() == '+' || okey.text() == '*' || okey.text() == '-' ||
                                okey.text() == '/' || okey.text() == '%'){
                                    var text;
                                    text = okey.text();
                                    if(bool_click == false){
                                        $('#result').text(eexAns);
                                        currentPos = eexAns.length;
                                    }
                                    else{
                                        $('#result').text(displayValue);
                                        currentPos = displayValue.length;
                                    }
                                    currentPos = insertAtCursor("result", text, currentPos, text.length);
                                    bool_click = true;
                            }
                            else
                            {
                                    //함수 하나 추가해서 cos, sin, log 등등
                                    //괄호를 가질 수 있는 text인지 파악하고 해당 함수의
                                    //리턴값을 통해 text를 o.text()+()로 정해주자.
                                    var text;
                                    if(okey.text() == 'inverse'){
                                            text = 'inv';
                                    }
                                    else{
                                            text = okey.text();
                                    }
                                    currentPos = insertAtCursor("result", text, currentPos, text.length);
                                    bool_click = true;
                            }
                        }
    
                        e.preventDefault()
                    })
                })
    
            });
    
        //http://yamea-guide.tistory.com/64
            function draw(dict, dataSize) {
              try {
                var expression;
                var expr;
                var variable;
                var dataCount=0;
                var trace = {};
                //여러 그래프 정보들을 담아갈 객체
                var mainObject = new Array();
    
                for(var key in dict){
                    expression = dict[key];
                    //사용자 정의 함수들에서 식을 가져와 해당 expression을 그래프에 맞추기 위해 작업
                    var expr = math.compile(expression);
    
                    //key(f(x))에서 x를 잘라 x인지 다른 문자인지 판단하여 밑의 expr.eval부분에 삽입
                    //x만 그래프로 그려줄 수 있음.
                    variable = key.substr(2,1);
                    // evaluate the expression repeatedly for different values of x
                    if(variable == 'x'){
                            var xValues = math.range(parseInt(drawMin), parseInt(drawMax), 0.1).toArray();
                            var yValues = xValues.map(function (x) {
                                    return expr.eval({x: x});
                            });
                            trace[dataCount] = {
                                    type : 'scatter',
                                    x:xValues,
                                    y:yValues,
                                    mode:'lines',
                                    name: key,
                                    line:{
                                            width: 1
                                    }
                            }
                    mainObject[dataCount] = trace[dataCount];
                    dataCount++;
                    }
                }
    
                var tempdt = dataCount;
                var flag = 0;
                //교점 그려주기
                for(var key1 in dict){
                        for(var key2 in dict){
                                //x인 함수만 골라내기 위한 if문
                                if(key1.substr(2,1) != 'x' || key2.substr(2,1) != 'x'){
                                        continue;
                                }
                                if(flag == 0){
                                        //중복 방지 위한 if문, flag
                                        //못 만났으면 그냥 넘어가고 만났으면 flag=1설정 이후 넘어가기
                                        if(key1 == key2){
                                                flag=1;
                                                continue;
                                        }
                                        else{
                                            continue;
                                        }
                                }
                                //교점 구하기 위해 식 수정 f(x)-g(x)=0이 되는 점 찾기
                                var temp = "-"+"("+dict[key2]+")";
                                var texp = math.compile(dict[key1]+temp);
                                var realexp = math.compile(dict[key1]);
    
                                var shareP = math.range(parseInt(drawMin), parseInt(drawMax),0.1).toArray();
                                var xValues = shareP.map(function(x){
                                        //정확한 0을 계산하지 못하므로 근사치를 계산하여 교점으로 판단
                                        //eval하면 x좌표가 튀어나옴
                                            if(texp.eval({x: x}) >= -0.00001 && texp.eval({x: x}) <= 0.00001)
                                            {
                                                    return x;
                                            }
                                });
                                //해당 x좌표로 y좌표 매핑
                                var yValues = shareP.map(function(x){
                                    return realexp.eval({x:x});
                                });
                                
                            trace[dataCount] = {
                                    x:xValues,
                                    y:yValues,
                                    mode:'markers',
                                    name:'교점',
                                    marker:{
                                            size : 10
                                    }
                            }
                            mainObject[dataCount] = trace[dataCount];
                            dataCount++;
                        }
                        flag = 0;
                }
                //3차원이 아니기에 x만 입력 받아 그래프 그리기 가능하도록 할것.
    
                // render the plot using plotly
                //layout 띄울 창 크기에 맞추어 수정해주기
                    var layout = {
                            width : 360,
                            height: 380,
                    };
                    Plotly.newPlot('plot', mainObject, layout);
                
                    }
                    catch (err) {
                    console.error(err);
                    alert(err);
                    }
            }
    
            function savePosition(){
                currentPos = document.getElementById("result").selectionStart;
            }
                
            // textarea에서 커서 위치 파악하여 해당 위치에 삽입     
            // 참고 : http://itzone.tistory.com/272
            function insertAtCursor(areaId, text, currentPos, length) {
                    var txtarea = document.getElementById(areaId);
                    var scrollPos = txtarea.scrollTop;
                    var strPos = currentPos;
                    var result;
                    
                    var br = ((strPos == txtarea.selectionStart) ?
                            "ff" : (document.selection ? "ie" : "save" ) );
                    if (br == "ie") {
                            txtarea.focus();
                            var range = document.selection.createRange();
                            range.moveStart ('character', -txtarea.value.length);
                            strPos = range.text.length;
                    }
                    else if (br == "ff"){
                            strPos = txtarea.selectionStart;
                    }
                    else if(br == "save"){
                    }
                    var front = (txtarea.value).substring(0,strPos);
                    var back = (txtarea.value).substring(strPos,txtarea.value.length);
                    result=front+text+back;
    
                    if (br == "ie") {
                            txtarea.focus();
                            var range = document.selection.createRange();
                            range.moveStart ('character', -txtarea.value.length);
                            range.moveStart ('character', strPos);
                            range.moveEnd ('character', 0);
                            range.select();
                    }
                    else if (br == "ff") {
                            // txtarea.selectionStart = strPos;
                            // txtarea.selectionEnd = strPos;
                            // txtarea.focus();
                    }
                    txtarea.scrollTop = scrollPos;
    
    
                    //()가 text에 들어있다면 strPos를 왼쪽으로 한칸 땡겨주기
                    //return -1, if no match is found
                    //if(text.search('\(\)') == -1){
                    if(text.match(/\(\)/)){
                        //     strPos += length;
                            strPos += length
                            strPos -= 1;
                    }
                    else{
                        strPos += length;
                    }
                    displayValue = result;
                    $('#result').text(result);
                    return strPos;
            }
    
            // textarea에서 커서 위치 파악하여 해당 위치부터 제거
            function deleteAtCursor(areaId, currentPos){
                    var txtarea = document.getElementById(areaId);
                    var scrollPos = txtarea.scrollTop;
                    var strPos = currentPos;
                    var result;
                    // alert(currentPos);
                    var br = ((strPos == txtarea.selectionStart) ?
                            "ff" : (document.selection ? "ie" : "save" ) );
                    if (br == "ie") {
                            txtarea.focus();
                            var range = document.selection.createRange();
                            range.moveStart ('character', -txtarea.value.length);
                            strPos = range.text.length;
                    }
                    else if (br == "ff"){
                            strPos = txtarea.selectionStart;
                    }
                    else if(br == "save"){
                    }
    
                    var front = (txtarea.value).substring(0,strPos-1);
                    var back = (txtarea.value).substring(strPos,txtarea.value.length);
                    result=front+back;
                    if (br == "ie") {
                            txtarea.focus();
                            var range = document.selection.createRange();
                            range.moveStart ('character', -txtarea.value.length);
                            range.moveStart ('character', strPos);
                            range.moveEnd ('character', 0);
                            range.select();
                    }
                    txtarea.scrollTop = scrollPos;
                    strPos -= 1;
                    displayValue = result;
                    $('#result').text(result);
                    return strPos;
            }
            
            //r은 입력 받은 값, p는 slidercontainer의 max인지 min인지 파악하여
            //getObject를 통해 자식을 찾게된다.
            function range(r, p){
                    var o;
                    var dtlist;
                    var lb;
                    //정의역으로 사용할 min값, max값을 비교하여
                    //min을 클릭하였을 때 max를 넘지 않게
                    //max를 클릭하였을 때 min보다 작지 않게 조정해준다.
                if(p == getObject("slidecontainer-max")){
                        o = getObject("rmax");
                        dtlist = getObject("tickmarks-max");
                        lb = getObject("lb_range_max");
                        if(r < drawMin){
                                r = drawMax;
                        }
                        else{
                                drawMax = r;
                        }
                }
                else if(p == getObject("slidecontainer-min")){
                        o = getObject("rmin");
                        dtlist = getObject("tickmarks-min");
                        lb = getObject("lb_range_min");
                        if(drawMax < r){
                                r = drawMin;
                        }
                        else{
                                drawMin = r;
                        }
                }
              o.min = parseInt(r) - 25;
              o.max = parseInt(r) + 25;

              dtlist.options[0].value = o.min;
              dtlist.options[1].value = parseInt(r) -13;
              dtlist.options[2].value = parseInt(r);
              dtlist.options[3].value = parseInt(r) + 13;
              dtlist.options[4].value = o.max;
              
              lb.innerHTML = o.min+"  "+dtlist.options[1].value+"  "+r+"  "+dtlist.options[3].value+"   "+o.max;
              $("#plot").empty();
              draw(dict,dataSize);
            }
          
            function changetick(v, p){
                var o;
                if(p == getObject("slidecontainer-max")){
                        o = getObject("rmax");
                }
                else if(p == getObject("slidecontainer-min")){
                        o = getObject("rmin");
                }
                if(v == "-"){
                        range(parseInt(--o.value), p);
                }
                else if(v == "+"){
                        range(parseInt(++o.value), p);
                }
            }

            function getObject(id){
                 return document.getElementById(id);
            }
        </script>
    
        <!-- 클릭 event JS -->
        <!-- 원형 펼치기 참조 : http://www.blueb.co.kr/?c=2/31&cat=%EA%B8%B0%ED%83%80%EB%A9%94%EB%89%B4&uid=3969 -->
        <script type="text/javascript">
            $( document ).ready( function() {
                    // 상위 메뉴 클릭시 하위 메뉴 토글
                    // 하위 메뉴 아이템 클릭시 하위 메뉴 사라지게
    
                    // 삼각함수
                    var tripleF_subL = $( '.tri-', this ).length;
                    $("#tri-menu-open").change(function(){
                            if($("#tri-menu-open").is(":checked")){
                                $( '#tri-F' ).children().each( function(i, element) {
                                        var offset = 360.0/tripleF_subL;
                                        var left =  70*Math.cos(Math.PI *offset*i/ 180.0);
                                        var top = 70*Math.sin(Math.PI *offset*i/ 180.0);
                                        
                                        $( element ).css('-webkit-transition-duration', '30ms');
                                        $( element ).css('transition-duration', '30ms');
                                        $( element ).css('-webkit-transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('visibility', 'visible');
                                
                                } );
                            }else{
                                    $( '#tri-F' ).children().each( function(i, element) {
                                            $( element ).css('-webkit-transition-duration', '30ms');
                                            $( element ).css('transition-duration', '30ms');
                                            $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('visibility', 'hidden');
                                    } );
                            }
                    });
    
                    $(".tri-").click(function(){
                            $('#tri-F').children().each( function(i, element) {
                                    $( element ).css('-webkit-transition-duration', '15ms');
                                    $( element ).css('transition-duration', '15ms');
                                    $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('visibility', 'hidden');
                            });
                            // jQuery 1.6+
                            $("#tri-menu-open").prop("checked", false);
                            // jQuery < 1.6
                            $("#tri-menu-open").attr("checked", false);
                    })
    
                    // 특수함수
                    var specF_subL = $( '.spec-', this ).length;
                    $("#spec-menu-open").change(function(){
                            if($("#spec-menu-open").is(":checked")){
                                    // alert(tripleF_subL);
                                $( '#spec-F' ).children().each( function(i, element) {
                                        //각도 라디안 아님
                                        var offset = 360.0/specF_subL;
                                        var left =  70*Math.cos(Math.PI *offset*i/ 180.0);
                                        var top = 70*Math.sin(Math.PI *offset*i/ 180.0);
                                        // alert(left);
                                        $( element ).css('-webkit-transition-duration', '30ms');
                                        $( element ).css('transition-duration', '30ms');
                                        $( element ).css('-webkit-transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('visibility', 'visible');
                                } );
                            }else{
                                    // alert("체크박스 체크 해제!");
                                    $( '#spec-F' ).children().each( function(i, element) {
                                            //각도 라디안 아님
                                            // alert(left);
                                            $( element ).css('-webkit-transition-duration', '30ms');
                                            $( element ).css('transition-duration', '30ms');
                                            $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('visibility', 'hidden');
                                    } );
                            }
                    });
                    
                    $(".spec-").click(function(){
                            $('#spec-F').children().each( function(i, element) {
                                    //각도 라디안 아님
                                    $( element ).css('-webkit-transition-duration', '15ms');
                                    $( element ).css('transition-duration', '15ms');
                                    $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('visibility', 'hidden');
                            });
                            // jQuery 1.6+
                            $("#spec-menu-open").prop("checked", false);
                            // jQuery < 1.6
                            $("#spec-menu-open").attr("checked", false);
                            // alert($("#tri-menu-open").is(":checked"));
                    })
    
                    // 비교연산
                    var diffF_subL = $( '.diff-', this ).length;
                    $("#diff-menu-open").change(function(){
                            if($("#diff-menu-open").is(":checked")){
                                    // alert(tripleF_subL);
                                $( '#diff-F' ).children().each( function(i, element) {
                                        //각도 라디안 아님
                                        var offset = 360.0/diffF_subL;
                                        var left =  70*Math.cos(Math.PI *offset*i/ 180.0);
                                        var top = 70*Math.sin(Math.PI *offset*i/ 180.0);
                                        // alert(left);
                                        $( element ).css('-webkit-transition-duration', '30ms');
                                        $( element ).css('transition-duration', '30ms');
                                        $( element ).css('-webkit-transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('visibility', 'visible');
                                } );
                            }else{
                                    // alert("체크박스 체크 해제!");
                                    $( '#diff-F' ).children().each( function(i, element) {
                                            //각도 라디안 아님
                                            // alert(left);
                                            $( element ).css('-webkit-transition-duration', '30ms');
                                            $( element ).css('transition-duration', '30ms');
                                            $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('visibility', 'hidden');
                                    } );
                            }
                    });
                    
                    $(".diff-").click(function(){
                            $('#diff-F').children().each( function(i, element) {
                                    //각도 라디안 아님
                                    $( element ).css('-webkit-transition-duration', '15ms');
                                    $( element ).css('transition-duration', '15ms');
                                    $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('visibility', 'hidden');
                            });
                            // jQuery 1.6+
                            $("#diff-menu-open").prop("checked", false);
                            // jQuery < 1.6
                            $("#diff-menu-open").attr("checked", false);
                            // alert($("#tri-menu-open").is(":checked"));
                    })
    
                    // 변수
                    var varF_subL = $( '.var-', this ).length;
                    $("#var-menu-open").change(function(){
                            if($("#var-menu-open").is(":checked")){
                                    // alert(tripleF_subL);
                                $( '#var-F' ).children().each( function(i, element) {
                                        //각도 라디안 아님
                                        var offset = 360.0/varF_subL;
                                        var left =  70*Math.cos(Math.PI *offset*i/ 180.0);
                                        var top = 70*Math.sin(Math.PI *offset*i/ 180.0);
                                        // alert(left);
                                        $( element ).css('-webkit-transition-duration', '30ms');
                                        $( element ).css('transition-duration', '30ms');
                                        $( element ).css('-webkit-transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('visibility', 'visible');
                                } );
                            }else{
                                    // alert("체크박스 체크 해제!");
                                    $( '#var-F' ).children().each( function(i, element) {
                                            //각도 라디안 아님
                                            // alert(left);
                                            $( element ).css('-webkit-transition-duration', '30ms');
                                            $( element ).css('transition-duration', '30ms');
                                            $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('visibility', 'hidden');
                                    } );
                            }
                    });
                    
                    $(".var-").click(function(){
                            $('#var-F').children().each( function(i, element) {
                                    //각도 라디안 아님
                                    $( element ).css('-webkit-transition-duration', '15ms');
                                    $( element ).css('transition-duration', '15ms');
                                    $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('visibility', 'hidden');
                            });
                            // jQuery 1.6+
                            $("#var-menu-open").prop("checked", false);
                            // jQuery < 1.6
                            $("#var-menu-open").attr("checked", false);
                            // alert($("#tri-menu-open").is(":checked"));
                    })
                    
                    // 함수
                    var funcF_subL = $( '.func-', this ).length;
                    $("#func-menu-open").change(function(){
                            if($("#func-menu-open").is(":checked")){
                                    // alert(tripleF_subL);
                                $( '#func-F' ).children().each( function(i, element) {
                                        //각도 라디안 아님
                                        var offset = 360.0/funcF_subL;
                                        var left =  70*Math.cos(Math.PI *offset*i/ 180.0);
                                        var top = 70*Math.sin(Math.PI *offset*i/ 180.0);
                                        // alert(left);
                                        $( element ).css('-webkit-transition-duration', '30ms');
                                        $( element ).css('transition-duration', '30ms');
                                        $( element ).css('-webkit-transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('visibility', 'visible');
                                } );
                            }else{
                                    // alert("체크박스 체크 해제!");
                                    $( '#func-F' ).children().each( function(i, element) {
                                            //각도 라디안 아님
                                            // alert(left);
                                            $( element ).css('-webkit-transition-duration', '30ms');
                                            $( element ).css('transition-duration', '30ms');
                                            $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('visibility', 'hidden');
                                    } );
                            }
                    });
                    
                    $(".func-").click(function(){
                            $('#func-F').children().each( function(i, element) {
                                    //각도 라디안 아님
                                    $( element ).css('-webkit-transition-duration', '15ms');
                                    $( element ).css('transition-duration', '15ms');
                                    $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('visibility', 'hidden');
                            });
                            // jQuery 1.6+
                            $("#func-menu-open").prop("checked", false);
                            // jQuery < 1.6
                            $("#func-menu-open").attr("checked", false);
                            // alert($("#tri-menu-open").is(":checked"));
                    })
                    
                    // 상수
                    var constF_subL = $( '.const-', this ).length;
                    $("#const-menu-open").change(function(){
                            if($("#const-menu-open").is(":checked")){
                                    // alert(tripleF_subL);
                                $( '#const-F' ).children().each( function(i, element) {
                                        //각도 라디안 아님
                                        var offset = 360.0/constF_subL;
                                        var left =  70*Math.cos(Math.PI *offset*i/ 180.0);
                                        var top = 70*Math.sin(Math.PI *offset*i/ 180.0);
                                        // alert(left);
                                        $( element ).css('-webkit-transition-duration', '30ms');
                                        $( element ).css('transition-duration', '30ms');
                                        $( element ).css('-webkit-transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('visibility', 'visible');
                                } );
                            }else{
                                    // alert("체크박스 체크 해제!");
                                    $( '#const-F' ).children().each( function(i, element) {
                                            //각도 라디안 아님
                                            // alert(left);
                                            $( element ).css('-webkit-transition-duration', '30ms');
                                            $( element ).css('transition-duration', '30ms');
                                            $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('visibility', 'hidden');
                                    } );
                            }
                    });
                    
                    $(".const-").click(function(){
                            $('#const-F').children().each( function(i, element) {
                                    //각도 라디안 아님
                                    $( element ).css('-webkit-transition-duration', '15ms');
                                    $( element ).css('transition-duration', '15ms');
                                    $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('visibility', 'hidden');
                            });
                            // jQuery 1.6+
                            $("#const-menu-open").prop("checked", false);
                            // jQuery < 1.6
                            $("#const-menu-open").attr("checked", false);
                            // alert($("#tri-menu-open").is(":checked"));
                    })
                    
                    // 상수
                    var procF_subL = $( '.proc-', this ).length;
                    $("#proc-menu-open").change(function(){
                            if($("#proc-menu-open").is(":checked")){
                                    // alert(tripleF_subL);
                                $( '#proc-F' ).children().each( function(i, element) {
                                        //각도 라디안 아님
                                        var offset = 360.0/procF_subL;
                                        var left =  70*Math.cos(Math.PI *offset*i/ 180.0);
                                        var top = 70*Math.sin(Math.PI *offset*i/ 180.0);
                                        // alert(left);
                                        $( element ).css('-webkit-transition-duration', '30ms');
                                        $( element ).css('transition-duration', '30ms');
                                        $( element ).css('-webkit-transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('transform', 'translate3d('+left+'px, '+top+'px, 0)');
                                        $( element ).css('visibility', 'visible');
                                } );
                            }else{
                                    // alert("체크박스 체크 해제!");
                                    $( '#proc-F' ).children().each( function(i, element) {
                                            //각도 라디안 아님
                                            // alert(left);
                                            $( element ).css('-webkit-transition-duration', '30ms');
                                            $( element ).css('transition-duration', '30ms');
                                            $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                            $( element ).css('visibility', 'hidden');
                                    } );
                            }
                    });
                    
                    $(".proc-").click(function(){
                            $('#proc-F').children().each( function(i, element) {
                                    //각도 라디안 아님
                                    $( element ).css('-webkit-transition-duration', '15ms');
                                    $( element ).css('transition-duration', '15ms');
                                    $( element ).css('-webkit-transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('transform', 'translate3d(0px, 0px, 0)');
                                    $( element ).css('visibility', 'hidden');
                            });
                            // jQuery 1.6+
                            $("#proc-menu-open").prop("checked", false);
                            // jQuery < 1.6
                            $("#proc-menu-open").attr("checked", false);
                            // alert($("#tri-menu-open").is(":checked"));
                    })
    
                    $("#mode-menu-open").change(function(){
                            if($("#mode-menu-open").is(":checked")){
                                    $('#graph_div').css('display', 'block');
                                    $('#slidecontainer-max').css('display', 'inline-block');
                                    $('#slidecontainer-min').css('display', 'inline-block');
                                    $("#plot").css('display', 'block');
                                    event.preventDefault();
                                    draw(dict,dataSize);
                            }
                            else{
                                        $('#graph_div').css('display', 'none');
                                        $('#slidecontainer-max').css('display', 'none');
                                        $('#slidecontainer-min').css('display', 'none');
                                        $("#plot").empty();
                            }
                    })
            } );
        </script>
</html>